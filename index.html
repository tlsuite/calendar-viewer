<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calendar View</title>

  <style>
    html, body {
      margin: 0;
      height: 100%;
      width: 100%;
      background: #fff;
      overflow: hidden;
    }
    #pdfFrame {
      border: 0;
      width: 100vw;
      height: 100vh;
      display: block;
      background: #fff;
    }
  </style>
</head>

<body>
  <iframe id="pdfFrame" title="PDF Viewer" allow="fullscreen"></iframe>

  <script>
    // ====== PATHS (UPDATED FOR YOUR PDF LOCATION) ======
    // Your PDF is in: pdfjs/web/pdfs/calendar-jan.pdf
    const PDF_FILE = "./pdfjs/web/pdfs/calendar-jan.pdf";
    const PDFJS_VIEWER = "./pdfjs/web/viewer.html";
    // ====================================================

    const iframe = document.getElementById("pdfFrame");

    const viewerUrl =
      `${PDFJS_VIEWER}?file=${encodeURIComponent(PDF_FILE)}` +
      `#page=1&zoom=page-fit&pagemode=none`;

    iframe.src = viewerUrl;

    document.addEventListener("webviewerloaded", () => {
      try {
        const win = iframe.contentWindow;
        if (!win || !win.PDFViewerApplicationOptions) return;

        // 0=auto, 1=light, 2=dark
        win.PDFViewerApplicationOptions.set("viewerCssTheme", 1);

        // Force consistent defaults:
        win.PDFViewerApplicationOptions.set("defaultZoomValue", "page-fit");
        win.PDFViewerApplicationOptions.set("scrollModeOnLoad", 3);
        win.PDFViewerApplicationOptions.set("spreadModeOnLoad", 0);

        if (win.PDFViewerApplication && typeof win.PDFViewerApplication._forceCssTheme === "function") {
          win.PDFViewerApplication._forceCssTheme();
        }
      } catch (e) {
        console.warn("PDF.js pre-init option set failed:", e);
      }
    });

    iframe.addEventListener("load", () => {
      try {
        const doc = iframe.contentDocument;
        if (!doc) return;

        const style = doc.createElement("style");
        style.textContent = `
          #toolbarContainer,
          #secondaryToolbar,
          #sidebarContainer,
          #sidebarResizer,
          #loadingBar,
          #errorWrapper {
            display: none !important;
          }

          #mainContainer,
          #viewerContainer {
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
          }

          html, body,
          #outerContainer,
          #mainContainer,
          #viewerContainer {
            background: #ffffff !important;
          }

          .page {
            box-shadow: none !important;
            border: none !important;
          }
        `;
        doc.head.appendChild(style);

        const win = iframe.contentWindow;
        if (win && win.PDFViewerApplication && win.PDFViewerApplication.initializedPromise) {
          win.PDFViewerApplication.initializedPromise.then(() => {
            try {
              const app = win.PDFViewerApplication;
              if (app.pdfViewer) {
                app.pdfViewer.scrollMode = 3;         // Page scrolling
                app.pdfViewer.spreadMode = 0;         // No spreads (no 2-up)
                app.pdfViewer.currentScaleValue = "page-fit";
              }
              if (app.page !== 1) app.page = 1;
            } catch (e) {
              console.warn("PDF.js post-init enforcement failed:", e);
            }
          });
        }
      } catch (e) {
        console.warn("CSS injection failed:", e);
      }
    });
  </script>
</body>
</html>