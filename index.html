<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calendar View</title>

  <style>
    html, body {
      margin: 0;
      height: 100%;
      width: 100%;
      background: #fff;
      overflow: hidden;
    }
    #pdfFrame {
      border: 0;
      width: 100vw;
      height: 100vh;
      display: block;
      background: #fff;
    }
  </style>
</head>

<body>
  <iframe id="pdfFrame" title="PDF Viewer" allow="fullscreen"></iframe>

  <script>
    // Viewer location (relative to index.html in repo root)
    const PDFJS_VIEWER = "pdfjs/web/viewer.html";

    // IMPORTANT: this path is resolved relative to viewer.html (pdfjs/web/)
    // Since your PDF is in pdfjs/web/pdfs/, use just "pdfs/<file>.pdf"
    const PDF_FILE_FOR_VIEWER = "pdfs/calendar-jan.pdf";

    const iframe = document.getElementById("pdfFrame");

    // Start at page 1, page-fit. (Hash params are supported by the viewer.)
    const viewerUrl =
      `${PDFJS_VIEWER}?file=${encodeURIComponent(PDF_FILE_FOR_VIEWER)}` +
      `#page=1&zoom=page-fit&pagemode=none`;

    iframe.src = viewerUrl;

    iframe.addEventListener("load", () => {
      try {
        const win = iframe.contentWindow;
        const doc = iframe.contentDocument;
        if (!win || !doc) return;

        // Inject CSS for: no toolbar/sidebar; pure-white background
        const style = doc.createElement("style");
        style.textContent = `
          /* Hide PDF.js chrome */
          #toolbarContainer,
          #secondaryToolbar,
          #sidebarContainer,
          #sidebarResizer,
          #loadingBar {
            display: none !important;
          }

          /* Let the PDF fill the entire frame */
          #mainContainer,
          #viewerContainer {
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
          }

          /* Force pure white background everywhere */
          html, body,
          #outerContainer,
          #mainContainer,
          #viewerContainer {
            background: #ffffff !important;
          }

          /* Optional: remove shadows/borders around pages */
          .page {
            box-shadow: none !important;
            border: none !important;
          }
        `;
        doc.head.appendChild(style);

        // After PDF.js is fully initialized, force the exact viewing mode:
        // - Page scrolling (one page at a time)
        // - No spreads (no 2-up)
        // - Page-fit zoom
        if (win.PDFViewerApplication && win.PDFViewerApplication.initializedPromise) {
          win.PDFViewerApplication.initializedPromise.then(() => {
            const app = win.PDFViewerApplication;

            if (app.pdfViewer) {
              // 3 = Page scrolling (one page at a time)
              app.pdfViewer.scrollMode = 3;

              // 0 = No spreads (prevents 2-up / book view)
              app.pdfViewer.spreadMode = 0;

              // Force fit-to-page
              app.pdfViewer.currentScaleValue = "page-fit";
            }

            // Ensure page 1
            if (app.page !== 1) app.page = 1;

            // Force light theme if supported (prevents gray/dark theming surprises)
            if (win.PDFViewerApplicationOptions) {
              // 0=auto, 1=light, 2=dark
              win.PDFViewerApplicationOptions.set("viewerCssTheme", 1);
            }
            if (typeof app._forceCssTheme === "function") app._forceCssTheme();
          });
        }
      } catch (e) {
        // If something fails, don't crash the page.
        console.warn("Viewer tweak failed:", e);
      }
    });
  </script>
</body>
</html>
